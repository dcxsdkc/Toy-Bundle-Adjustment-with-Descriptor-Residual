## 📌 项目概述：Toy Bundle Adjustment with Descriptor Residual

本项目旨在构建一个 **Toy Bundle Adjustment (BA)** 骨架系统，用于验证引入 SuperPoint 特征描述子残差对 BA 优化精度的提升效果。

## 🎯 出发点与目标

* 结合视觉 SLAM 中前端特征匹配与后端优化；
* 前端采用 SuperPoint + LightGlue 进行帧间匹配；
* 后端 BA 优化中联合使用 **坐标残差 + 描述子残差**；
* 实验场景为 synthetic 模拟构建（立方体三维结构 + 相机轨迹）；
* 对不同 λ 超参数下的优化结果进行对比可视化分析。
---
## 🧱 项目结构

| 模块                                          | 说明                                                        |
| --------------------------------------------- | -------------------------------------------------------------|
| generate_synthetic_ba_data()                  | 生成三维立方体点、相机轨迹及每点多帧观测，构造描述子和像素噪声    |
| run_bundle_adjustment()                       | 进行 BA 优化，支持不同 λ 的 descriptor loss 加权               |
| visualize_multiple_pointclouds_with_lines()   | 多组点云可视化，支持连线绘制立方体结构                          |
| save_matching_results() (后续)                | 替换 synthetic 数据为真实 SuperPoint/LightGlue 匹配结果（准备中 |
---
## ✅ 当前进展
* [x] 已完成立方体角点 + 边中点构成的 20 点 3D 模拟数据；
* [x] 实现并测试多个 λ 超参数下的 BA 优化，导出三维点结果；
* [x] 构建三维可视化模块，支持多组结果叠加及立方体结构连线；
* [x] 发现并定位优化结果中点顺序错乱导致连线错乱问题；
* [x] GT 点云连线正确，优化结果尚未对齐 GT 顺序。
---
## 🧩 当前问题
1. **优化后的点集顺序未与 GT 对齐**，导致连线错误；
2. 立方体结构连线只在 GT 点正确，其余组错乱；
3. 需实现一个点云重排序逻辑，例如 `sort_points_like_gt()`；
4. 数据可视化需要更鲁棒地绑定角点索引和颜色。
---
## 🧠 待解决与后续工作
*  重排序所有点云，确保前 8 个角点与 GT 顺序一致；
*  引入真实特征提取和匹配模块替代模拟描述子；
*  可视化优化残差热度图，分析优化效果；
*  迁移优化模块至 C++，集成至 ORB-SLAM3 后端 BA 流程中；
*  添加相机姿态可视化与误差评估指标（RMSE 等）。

